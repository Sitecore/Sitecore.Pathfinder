# Code Generation
Pathfinder can generate code based on your project. The most obvious thing is to generate a C# class for each template in
the project.

To generate code, execute the task `generate-code`. This wil iterate through the elements in the project and check if
a code generator is available for that item. If so, the code generator is executed.

Code generators are simply extensions that are located in the [Tools]/extensions/codegen directory.

Normally you want to run the `generate-code` task before building an assembly, so the C# source files are up-to-date.

## T4
Watch the video: [06 - Visual Studio, T4 templates, unit testing with FakeDB](https://youtu.be/_v6-1NKgxT0)

Pathfinder supports code generation using T4 text templating. Pathfinder uses the 
[Mono Text Templating engine](https://github.com/mono/monodevelop/tree/master/main/src/addins/TextTemplating/Mono.TextTemplating) 
(not the Visual Studio one).

Pathfinder supports code generation on a project level and on an item level.

On a project level, Pathfinder will look for files with the extension ".project.tt" in the [Project] directory and below. For each
file found, it will invoke the text templating engine and pass the project model object as a parameter. The output file will
be located in the same directory as the ".project.tt" file, but the extension ".project.tt" will be removed. To create a 
"MyProject.cs" output file, name the T4 template file "MyProject.cs.project.tt".

On an item level, Pathfinder looks for file with the extension ".tt". If a found file ends with ".project.tt", it is ignored.
Otherwise Pathfinder will extract the "second last extension" and match this with the setting "generate-code:items" in the config
file. For instance the template "NameTemplate.cs.template.tt" will match the "template" entry. The entry specifies the type name of the
project items to be passed to the templating engine. The "template" entry specifies that project items of type 
"Sitecore.Pathfinder.Projects.Templates.Template,Sitecore.Pathfinder.Core.dll" should be processed, so Pathfinder will find all templates
in the project and pass each to the templating engine. The "Name" in the file name will be replace by the short name of the project item.

For instance in a project that has 4 templates (News, Product, Document, Info), the "NameTemplate.cs.template.tt" template will generate
4 files:

* NewsTemplate.cs
* ProductTemplate.cs
* DocumentTemplate.cs
* InfoTemplate.cs

Below is an example of how to create a project-level template, that generates a struct with IDs for all templates in the project.

TemplateIds.cs.project.tt:
```tt
<#@template language="C#" hostspecific="true" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Threading.Tasks" #>
<#@ import namespace="Sitecore.Pathfinder.Building" #>
<#@ import namespace="Sitecore.Pathfinder.Extensions" #>
<#@ import namespace="Sitecore.Pathfinder.Projects" #>
<#@ import namespace="Sitecore.Pathfinder.Projects.Items" #>
<#@ import namespace="Sitecore.Pathfinder.Projects.Templates" #>
<#@ import namespace="Sitecore.Pathfinder.T4.Code" #>
<# 
    IProject project = (Host as T4.Host).Project; 
    IBuildContext context = (Host as T4.Host).Context; 
#>
//------------------------------------------------------------------------------
// <auto-generated>
// This code was generated by a tool.
//
// Changes to this file may cause incorrect behavior and will be lost if
// the code is regenerated.
//
// </auto-generated>
//------------------------------------------------------------------------------
                
#pragma warning disable 1591

using Sitecore.Data;

namespace Sitecore
{
    #region Designer generated code

    public struct TemplateIds
    {
<# foreach(var template in project.Templates.OrderBy(t => t.Name))
{
#>
        public struct <# Write(template.Name.GetSafeCodeIdentifier()); #>
        
        {
            public static ID ID = new ID("<# Write(template.ID.ToString()); #>");
        }
        
<#
}
#>

    }

    #endregion
}                  

#pragma warning restore 1591
```

